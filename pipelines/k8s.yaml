.check-helm:
  stage: unit-test
  image: registry.dev.local/homelab/pipeline-catalog/k8s:latest
  variables:
    CHECK_PATH: ""
  script: | #shell
    cd $CHECK_PATH
    helm lint .
    helm template . > generated.yaml
    /kubeconform -summary -output json --strict generated.yaml > "report.json"
    cat generated.yaml
    echo "=============="
    cat report.json
  artifacts:
    paths:
      - ${CHECK_PATH}/report.json
      - ${CHECK_PATH}/generated.yam
    expire_in: 1 week
